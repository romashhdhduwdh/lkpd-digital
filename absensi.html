<!doctype html>
<html lang="en">
<head>
<link rel="stylesheet" type="text/css" href="base.css" />
<link rel="stylesheet" type="text/css" href="content.css" />
<link rel="stylesheet" type="text/css" href="nav.css" />
<meta http-equiv="content-type" content="text/html;  charset=utf-8" />
<title>ABSENSI | SMA NEGRI 13 BOMBANA </title>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<meta name="author" content="MEDIA GEOGRAFI" />
<link rel="license" type="text/html" href="http://creativecommons.org/licenses/by-nc-nd/4.0/" />
<meta name="generator" content="eXeLearning 2.9 - exelearning.net" />
<!--[if lt IE 9]><script type="text/javascript" src="exe_html5.js"></script><![endif]-->
<script type="text/javascript" src="exe_jquery.js"></script>
<script type="text/javascript" src="common_i18n.js"></script>
<script type="text/javascript" src="common.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
    </head>
<body class="exe-web-site exe-search-bar" id="exe-node-20"><script type="text/javascript">document.body.className+=" js"</script>
<div id="content">
<p id="skipNav"><a href="#main" class="sr-av">Skip navigation</a></p>
<header id="header" ><div id="headerContent">SMA NEGRI 13 BOMBANA</div></header>
<nav id="siteNav">
<ul>
   <li><a href="index.html" class="daddy main-node">SMA NEGRI 13 BOMBANA</a></li>
   <li><a href="tujuan_pembelajaran_geografi.html" class="no-ch">TUJUAN PEMBELAJARAN GEOGRAFI</a></li>
   <li><a href="materi_geografi.html" class="daddy">MATERI GEOGRAFI</a>
   <ul class="other-section">
      <li><a href="pertemuan_ke1.html" class="no-ch">PERTEMUAN KE-1</a></li>
      <li><a href="pertemuan_ke2.html" class="no-ch">PERTEMUAN KE-2</a></li>
      <li><a href="pertemuan_ke3.html" class="no-ch">PERTEMUAN KE-3</a></li>
   </ul>
   </li>
   <li><a href="lembar_kerja_peserta_didik.html" class="daddy">LEMBAR KERJA PESERTA DIDIK</a>
   <ul class="other-section">
      <li><a href="lembar_kerja_ke1.html" class="no-ch">LEMBAR KERJA KE-1</a></li>
      <li><a href="lembar_kerja_ke2.html" class="no-ch">LEMBAR KERJA KE-2</a></li>
      <li><a href="lembar_kerja_ke3.html" class="no-ch">LEMBAR KERJA KE-3</a></li>
   </ul>
   </li>
   <li id="active"><a href="absensi.html" class="active no-ch">ABSENSI</a></li>
</ul>
</nav>
<div id='topPagination'>
<nav class="pagination noprt">
<a href="lembar_kerja_ke3.html" class="prev"><span><span>&laquo; </span>Previous</span></a>
</nav>
</div>
<div id="main-wrapper">
<section id="main">
<header id="nodeDecoration"><h1 id="nodeTitle">ABSENSI</h1></header>
<article class="iDevice_wrapper textIdevice" id="id24">
<div class="iDevice emphasis0" >
<div id="ta24_127_2" class="block iDevice_content">
<div class="exe-text"><p></p>
<style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
    }

    input, select, button {
      padding: 8px;
      margin: 5px 0;
      width: 100%;
      box-sizing: border-box;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }

    table, th, td {
      border: 1px solid #ccc;
    }

    th, td {
      padding: 10px;
      text-align: left;
    }

    .form-group {
      margin-bottom: 15px;
    }

    button {
      background-color: #4CAF50;
      color: white;
      border: none;
      cursor: pointer;
    }

    button:hover {
      background-color: #45a049;
    }

    .aksi-btn {
      margin-right: 5px;
      padding: 5px 10px;
      font-size: 12px;
    }

    .edit-btn {
      background-color: #2196F3;
    }

    .hapus-btn {
      background-color: #f44336;
    }

    .edit-btn:hover {
      background-color: #1976D2;
    }

    .hapus-btn:hover {
      background-color: #d32f2f;
    }

    .utility-buttons {
      margin-top: 20px;
    }
  </style>
<h2>Form Absensi Siswa</h2>
<div class="form-group"><label for="nama">Nama Siswa:</label> <input type="text" id="nama" placeholder="Masukkan nama siswa" /></div>
<div class="form-group"><label for="kelas">Kelas:</label><select id="kelas">
<option value="">-- Pilih Kelas --</option>
<option value="10-IPS-1">10-IPS-1</option>
<option value="10-IPS-2">10-IPS-2</option>
<option value="10-IPA">10-IPA</option>
<option value="10-BAHASA">10-BAHASA</option>
</select></div>
<div class="form-group"><label for="mapel">Mata Pelajaran:</label><select id="mapel">
<option value="">-- Pilih Mata Pelajaran --</option>
<option value="GEOGRAFI">GEOGRAFI</option>
</select></div>
<div class="form-group"><label for="hasil">Hasil Kerja Siswa:</label> <input type="text" id="hasil" placeholder="Masukkan hasil kerja atau link tugas" /></div>
<p><button onclick="absen()">Absen</button></p>
<table id="tabelAbsensi">
<thead>
<tr>
<th>No</th>
<th>Nama Siswa</th>
<th>Kelas</th>
<th>Mata Pelajaran</th>
<th>Waktu Absen</th>
<th>Hasil Kerja</th>
<th>Aksi</th>
</tr>
</thead>
<tbody><!-- Data akan muncul di sini --></tbody>
</table>
<!-- Tombol Ekspor -->
<div class="utility-buttons"><button onclick="downloadCSV()">Download Data (CSV)</button></div>
<p>
<script>
    let no = 1;

    function absen() {
      const nama = document.getElementById('nama').value.trim();
      const kelas = document.getElementById('kelas').value;
      const mapel = document.getElementById('mapel').value;
      const hasil = document.getElementById('hasil').value.trim();

      if (nama === '' || kelas === '' || mapel === '') {
        alert('Harap isi semua data terlebih dahulu!');
        return;
      }

      const waktu = new Date().toLocaleString();
      const tabel = document.getElementById('tabelAbsensi').getElementsByTagName('tbody')[0];
      const baris = tabel.insertRow();

      baris.insertCell(0).innerText = no++;
      baris.insertCell(1).innerText = nama;
      baris.insertCell(2).innerText = kelas;
      baris.insertCell(3).innerText = mapel;
      baris.insertCell(4).innerText = waktu;
      baris.insertCell(5).innerText = hasil;

      const aksiCell = baris.insertCell(6);
      aksiCell.innerHTML = `
        <button class="aksi-btn edit-btn" onclick="editBaris(this)">Edit</button>
        <button class="aksi-btn hapus-btn" onclick="hapusBaris(this)">Hapus</button>
      `;

      // Reset input
      document.getElementById('nama').value = '';
      document.getElementById('kelas').value = '';
      document.getElementById('mapel').value = '';
      document.getElementById('hasil').value = '';
    }

    function hapusBaris(button) {
      const baris = button.parentNode.parentNode;
      baris.remove();
      updateNomor();
    }

    function editBaris(button) {
      const baris = button.parentNode.parentNode;
      const cells = baris.getElementsByTagName('td');

      document.getElementById('nama').value = cells[1].innerText;
      document.getElementById('kelas').value = cells[2].innerText;
      document.getElementById('mapel').value = cells[3].innerText;
      document.getElementById('hasil').value = cells[5].innerText;

      baris.remove();
      updateNomor();
    }

    function updateNomor() {
      const rows = document.getElementById('tabelAbsensi').getElementsByTagName('tbody')[0].rows;
      no = 1;
      for (let i = 0; i < rows.length; i++) {
        rows[i].cells[0].innerText = no++;
      }
    }

    // Fungsi untuk mengunduh data dalam format CSV
    function downloadCSV() {
      const rows = document.querySelectorAll('#tabelAbsensi tr');
      let csvContent = "";

      rows.forEach(row => {
        const cols = row.querySelectorAll('td, th');
        const rowData = Array.from(cols).map(cell => `"${cell.innerText}"`).join(',');
        csvContent += rowData + "\r\n";
      });

      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement("a");

      link.setAttribute("href", url);
      link.setAttribute("download", "data_absensi.csv");
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    }
  </script>
</p></div>
</div>
</div>
</article>
<div id="packageLicense" class="cc cc-by-nc-nd">
<p><span>Licensed under the</span> <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution Non-commercial No Derivatives License 4.0</a></p>
</div>
</section>
</div>
<div id='bottomPagination'>
<nav class="pagination noprt">
<a href="lembar_kerja_ke3.html" class="prev"><span><span>&laquo; </span>Previous</span></a>
</nav>
</div>
</div>
<p id="made-with-eXe"><a href="https://exelearning.net/" target="_blank" rel="noopener"><span>Made with eXeLearning<span> (New Window)</span></span></a></p><script type="text/javascript" src="_style_js.js"></script></body></html>